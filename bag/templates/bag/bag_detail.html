{% block content %}
  <h2>Your Shopping Bag</h2>
  
  {% if bag %}
    <ul>
      {% for item in bag %}  {# Uses Bag.__iter__() to loop through items #}
        <li>
          {{ item.product.name }} - Quantity: {{ item.quantity }} - £{{ item.total_price|floatformat:2 }}
          <a href="{% url 'bag_remove' item.product.id %}">Remove</a>
        </li>
      {% endfor %}
    </ul>
    <p><strong>Total:</strong> £{{ total|floatformat:2 }}</p>
    <a href="{% url 'checkout' %}" class="btn btn-primary">Proceed to Checkout</a>
  {% else %}
    <p>Your bag is empty.</p>
  {% endif %}
{% endblock %}