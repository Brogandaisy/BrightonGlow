{% extends 'base.html' %}

{% block content %}
  <h2>Checkout</h2>

  <h3>Your Shopping Bag</h3>

  {% if bag %}
    <ul>
      {% for item in bag %}  {# Uses Bag.__iter__() to loop through items #}
      <li>
        {{ item.product.name }} - Quantity: {{ item.quantity }} - £{{ item.total_price|floatformat:2 }}
      </li>
    {% endfor %}
    </ul>
    <p><strong>Total:</strong> £{{ total }}</p>
  {% else %}
    <p>Your shopping bag is empty.</p>
  {% endif %}

  <h3>Shipping Details</h3>
  {% if form %}
    <form method="post">
      {% csrf_token %}
      {{ form.as_p }}
      <button type="submit">Place Order</button>
    </form>
  {% else %}
    <p>Error loading form.</p>
  {% endif %}
{% endblock %}
